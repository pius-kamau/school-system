<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Add New Student</title>
    <style>
      /* ... (keep existing styles) ... */

      .photo-upload {
        border: 2px dashed #d1d5db;
        border-radius: 10px;
        padding: 30px;
        text-align: center;
        margin-bottom: 20px;
        transition: border-color 0.3s ease;
        cursor: pointer;
      }

      .photo-upload:hover {
        border-color: #4f46e5;
      }

      .photo-upload i {
        font-size: 48px;
        color: #9ca3af;
        margin-bottom: 15px;
      }

      .photo-preview {
        display: none;
        max-width: 200px;
        margin: 20px auto;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .photo-preview img {
        width: 100%;
        height: auto;
        display: block;
      }

      .file-input {
        display: none;
      }

      .remove-photo {
        display: none;
        margin-top: 10px;
        color: #ef4444;
        cursor: pointer;
        font-weight: 500;
      }

      .remove-photo:hover {
        text-decoration: underline;
      }

      .file-info {
        margin-top: 10px;
        color: #6b7280;
        font-size: 14px;
      }
    </style>
  </head>
  <body>
    <div class="form-container">
      <div class="form-header">
        <h1>âž• Add New Student</h1>
      </div>

      <form
        action="/students/new"
        method="POST"
        class="form-content"
        id="studentForm"
        enctype="multipart/form-data"
      >
        <!-- Photo Upload Section -->
        <div
          class="photo-upload"
          onclick="document.getElementById('photoInput').click()"
        >
          <div>ðŸ“·</div>
          <h3>Upload Student Photo</h3>
          <p>Click to select a photo (JPG, PNG, GIF - max 5MB)</p>
          <input
            type="file"
            name="photo"
            id="photoInput"
            class="file-input"
            accept="image/*"
            onchange="previewPhoto(event)"
          />
        </div>

        <div class="photo-preview" id="photoPreview">
          <img id="previewImage" src="" alt="Photo Preview" />
          <div class="remove-photo" onclick="removePhoto()">Remove Photo</div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="required">Full Name</label>
            <input
              type="text"
              name="name"
              placeholder="Enter student's full name"
              required
            />
            <div class="error-message" id="nameError">Name is required</div>
          </div>

          <div class="form-group">
            <label>Gender</label>
            <select name="gender">
              <option value="">Select Gender</option>
              <option value="Male">Male</option>
              <option value="Female">Female</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label class="required">Class/Grade</label>
          <input
            type="text"
            name="class"
            placeholder="e.g., Grade 6, Form 2"
            required
          />
          <div class="error-message" id="classError">Class is required</div>
        </div>

        <div class="form-group">
          <label>Guardian's Name</label>
          <input
            type="text"
            name="guardian_name"
            placeholder="Enter guardian's name"
          />
        </div>

        <div class="form-group">
          <label>Date of Birth</label>
          <input type="date" name="dob" />
        </div>

        <div class="form-actions">
          <a href="/students" class="btn btn-cancel">Cancel</a>
          <button type="submit" class="btn btn-submit">Save Student</button>
        </div>
      </form>
    </div>

    <script>
      function previewPhoto(event) {
        const input = event.target;
        const preview = document.getElementById("photoPreview");
        const previewImage = document.getElementById("previewImage");
        const removeBtn = document.querySelector(".remove-photo");

        if (input.files && input.files[0]) {
          const reader = new FileReader();

          reader.onload = function (e) {
            previewImage.src = e.target.result;
            preview.style.display = "block";
            removeBtn.style.display = "block";

            // Show file info
            const file = input.files[0];
            const fileSize = (file.size / 1024 / 1024).toFixed(2); // MB
            document.querySelector(
              ".photo-upload p"
            ).textContent = `${file.name} (${fileSize} MB) - Click to change`;
          };

          reader.readAsDataURL(input.files[0]);
        }
      }

      function removePhoto() {
        const input = document.getElementById("photoInput");
        const preview = document.getElementById("photoPreview");
        const removeBtn = document.querySelector(".remove-photo");

        input.value = "";
        preview.style.display = "none";
        removeBtn.style.display = "none";
        document.querySelector(".photo-upload p").textContent =
          "Click to select a photo (JPG, PNG, GIF - max 5MB)";
      }

      // File size validation
      document
        .getElementById("photoInput")
        .addEventListener("change", function () {
          const file = this.files[0];
          const maxSize = 5 * 1024 * 1024; // 5MB

          if (file && file.size > maxSize) {
            alert("File size exceeds 5MB limit. Please choose a smaller file.");
            this.value = "";
            removePhoto();
          }
        });

      // Form validation (keep existing validation code)
      document
        .getElementById("studentForm")
        .addEventListener("submit", function (e) {
          let valid = true;

          // Name validation
          const name = document.getElementsByName("name")[0];
          const nameError = document.getElementById("nameError");
          if (!name.value.trim()) {
            nameError.style.display = "block";
            name.style.borderColor = "#ef4444";
            valid = false;
          } else {
            nameError.style.display = "none";
            name.style.borderColor = "#10b981";
          }

          // Class validation
          const studentClass = document.getElementsByName("class")[0];
          const classError = document.getElementById("classError");
          if (!studentClass.value.trim()) {
            classError.style.display = "block";
            studentClass.style.borderColor = "#ef4444";
            valid = false;
          } else {
            classError.style.display = "none";
            studentClass.style.borderColor = "#10b981";
          }

          if (!valid) {
            e.preventDefault();
            alert("Please fill in all required fields");
          }
        });
    </script>
  </body>
</html>
